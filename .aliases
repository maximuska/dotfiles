## .aliases
## Author: Maxim Kalaev

# Screen integration: update window title on ssh, etc.
# Todo: support deeper nesting.
function screen_title_save() {
        if [[ "$swin_title"x != ""x ]] ; then
            export sprev_title=$swin_title
        else
            export sprev_title="(unknown)"
        fi
}
function screen_win_title() {
        [[ "$TERM" == "screen" ]] && echo -n -e '\ek'$*'\e\'
}
# Store DISPLAY value when screen starts to allow getting an updated value in restored sessions
function screen() { echo -e "if [[ \$HOSTNAME == $HOSTNAME ]]; then export DISPLAY=$DISPLAY; fi" > ~/.sdisplay; `which screen` $*; }

function ssh() { _re='(^[A-z0-9]+)| ([A-z0-9]+)'; [[ $* =~ $_re ]] && screen_win_title ${BASH_REMATCH:0}; LC_MY_CWD_FOR_SSH=`pwd` `which ssh` $*; ret=$?; screen_win_title `hostname`;
return $ret;}

function gg() { git grep -n --color "$@" | sed -re "s/(:[^:]+):/\1 /"; }

function vi() {
    _re='(.*):([0-9]+)(:.*)?'
    if [[ "$*" =~ $_re ]]; then
        DISPLAY= vim ${BASH_REMATCH[1]} +${BASH_REMATCH[2]}
    else
        DISPLAY= vim "$@"
    fi
}

alias grep='grep --color --exclude=TAGS --exclude=tags'
alias zap='rm *~'
function md { mkdir -p "$@" ; cd "$1"; }
function mdd { md "`date +%F-%R`$@"; }
alias gl='global -x'
alias nas1b="ssh root@nas1b"
alias hd='hexdump'
alias p11='cd /local/home/maximk/p11.0/'
alias postreview='python2.7 ~/programs/python2.7/site-packages/rbtools/postreview.py'
alias ls='ls -F --color'
alias fullpath='python -c "import os, sys; print os.path.realpath(sys.argv[1])"'
alias less='less -fR'
